<!DOCTYPE html>
<html lang="ku" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø³ÛŒØ³ØªÛ•Ù…ÛŒ ÙØ§Ø³Øª ÙÛ†Ø¯</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
    :root {
        --primary: #667eea;
        --secondary: #764ba2;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        min-height: 100vh;
        padding: 20px;
    }

    .container {
        max-width: 1600px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        overflow: hidden;
    }

    .header {
        background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        color: white;
        padding: 30px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 20px;
    }

    .header h1 {
        font-size: 2.5em;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
    }

    .mode-toggle {
        display: flex;
        gap: 10px;
    }

    .mode-btn {
        background: rgba(255,255,255,0.2);
        color: white;
        border: 2px solid white;
        padding: 12px 25px;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1.1em;
    }

    .mode-btn.active {
        background: white;
        color: var(--primary);
    }

    .view {
        display: none;
    }

    .view.active {
        display: block;
    }

    .main-content {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 20px;
        padding: 20px;
    }

    .category-filter {
        padding: 20px;
        background: #f8f9fa;
        border-radius: 10px;
        margin-bottom: 20px;
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
    }

    .category-btn {
        padding: 10px 20px;
        border: 2px solid var(--primary);
        background: white;
        color: var(--primary);
        border-radius: 25px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1em;
    }

    .category-btn.active {
        background: var(--primary);
        color: white;
    }

    .products-section {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 15px;
    }

    .product-card {
        background: white;
        border: 2px solid #e0e0e0;
        border-radius: 15px;
        padding: 15px;
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: center;
        position: relative;
    }

    .product-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        border-color: var(--primary);
    }

    .product-card.out-of-stock {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .stock-badge {
        position: absolute;
        top: 10px;
        right: 10px;
        background: #e74c3c;
        color: white;
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 0.8em;
        font-weight: bold;
    }

    .stock-low {
        background: #f39c12;
    }

    .product-image {
        width: 100%;
        height: 150px;
        object-fit: cover;
        border-radius: 10px;
        margin-bottom: 10px;
    }

    .product-name {
        font-size: 1.2em;
        font-weight: bold;
        color: #333;
        margin-bottom: 8px;
    }

    .product-price {
        color: var(--primary);
        font-size: 1.3em;
        font-weight: bold;
    }

    .product-stock {
        font-size: 0.9em;
        color: #666;
        margin-top: 5px;
    }

    .cart-section {
        background: #f8f9fa;
        border-radius: 15px;
        padding: 20px;
        position: sticky;
        top: 20px;
    }

    .cart-title {
        font-size: 1.8em;
        color: #333;
        margin-bottom: 20px;
        text-align: center;
        padding-bottom: 15px;
        border-bottom: 3px solid var(--primary);
    }

    .delivery-section {
        background: white;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 15px;
    }

    .delivery-section h4 {
        color: var(--primary);
        margin-bottom: 10px;
    }

    .delivery-option {
        display: flex;
        gap: 10px;
        margin-bottom: 10px;
    }

    .delivery-option label {
        flex: 1;
        padding: 10px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        cursor: pointer;
        text-align: center;
        transition: all 0.3s ease;
    }

    .delivery-option input:checked + label {
        border-color: var(--primary);
        background: var(--primary);
        color: white;
    }

    .delivery-option input {
        display: none;
    }

    .cart-items {
        max-height: 300px;
        overflow-y: auto;
        margin-bottom: 20px;
    }

    .cart-item {
        background: white;
        padding: 15px;
        border-radius: 10px;
        margin-bottom: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .cart-item-controls {
        display: flex;
        gap: 10px;
        align-items: center;
    }

    .qty-btn {
        background: var(--primary);
        color: white;
        border: none;
        width: 35px;
        height: 35px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 1.2em;
    }

    .btn {
        width: 100%;
        border: none;
        padding: 15px;
        border-radius: 12px;
        font-size: 1.2em;
        cursor: pointer;
        margin-top: 10px;
        font-weight: bold;
        color: white;
        transition: all 0.3s ease;
    }

    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    .btn-primary {
        background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    }

    .btn-success {
        background: #2ecc71;
    }

    .btn-danger {
        background: #e74c3c;
    }

    .btn-warning {
        background: #f39c12;
    }

    .admin-container {
        padding: 30px;
    }

    .admin-tabs {
        display: flex;
        gap: 10px;
        margin-bottom: 30px;
        border-bottom: 2px solid #e0e0e0;
        flex-wrap: wrap;
    }

    .admin-tab {
        padding: 15px 30px;
        background: transparent;
        border: none;
        cursor: pointer;
        font-size: 1.1em;
        color: #666;
        border-bottom: 3px solid transparent;
    }

    .admin-tab.active {
        color: var(--primary);
        border-bottom-color: var(--primary);
    }

    .admin-content {
        display: none;
    }

    .admin-content.active {
        display: block;
    }

    .admin-card {
        background: #f8f9fa;
        padding: 30px;
        border-radius: 15px;
        margin-bottom: 20px;
    }

    .admin-card h3 {
        color: var(--primary);
        margin-bottom: 20px;
        font-size: 1.5em;
    }

    .form-group {
        margin-bottom: 20px;
    }

    .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: bold;
        color: #333;
    }

    .form-control {
        width: 100%;
        padding: 12px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 1em;
    }

    .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
    }

    .products-list {
        display: grid;
        gap: 15px;
    }

    .product-item {
        background: white;
        padding: 20px;
        border-radius: 10px;
        display: flex;
        gap: 20px;
        align-items: center;
    }

    .product-item img {
        width: 100px;
        height: 100px;
        object-fit: cover;
        border-radius: 10px;
    }

    .product-item-info {
        flex: 1;
    }

    .btn-small {
        padding: 8px 15px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 0.9em;
        color: white;
    }

    .btn-edit {
        background: #f39c12;
    }

    .btn-delete {
        background: #e74c3c;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }

    .stat-card {
        background: white;
        padding: 25px;
        border-radius: 15px;
        text-align: center;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .stat-number {
        font-size: 2.5em;
        font-weight: bold;
        color: var(--primary);
        margin-bottom: 10px;
    }

    .orders-list {
        display: grid;
        gap: 15px;
    }

    .order-item {
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .order-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        padding-bottom: 15px;
        border-bottom: 2px solid #f0f0f0;
    }

    .order-number {
        font-size: 1.3em;
        font-weight: bold;
        color: var(--primary);
    }

    .order-date {
        color: #666;
    }

    .order-items {
        margin-bottom: 15px;
    }

    .order-item-row {
        display: flex;
        justify-content: space-between;
        padding: 5px 0;
        color: #666;
    }

    .order-total {
        display: flex;
        justify-content: space-between;
        font-size: 1.3em;
        font-weight: bold;
        color: var(--primary);
        padding-top: 15px;
        border-top: 2px solid #f0f0f0;
    }

    .order-actions {
        display: flex;
        gap: 10px;
        margin-top: 15px;
    }

    .filter-buttons {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        flex-wrap: wrap;
    }

    .filter-btn {
        padding: 10px 20px;
        border: 2px solid var(--primary);
        background: white;
        color: var(--primary);
        border-radius: 25px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .filter-btn.active {
        background: var(--primary);
        color: white;
    }

    .expenses-list {
        display: grid;
        gap: 15px;
    }

    .expense-item {
        background: white;
        padding: 20px;
        border-radius: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.8);
        z-index: 1000;
        align-items: center;
        justify-content: center;
    }

    .modal.active {
        display: flex;
    }

    .modal-content {
        background: white;
        padding: 40px;
        border-radius: 20px;
        max-width: 600px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
    }

    .receipt {
        background: white;
        padding: 30px;
        border-radius: 10px;
        max-width: 400px;
        margin: 0 auto;
    }

    .receipt-header {
        text-align: center;
        margin-bottom: 20px;
        padding-bottom: 20px;
        border-bottom: 2px dashed #333;
    }

    .receipt-title {
        font-size: 1.8em;
        font-weight: bold;
        color: var(--primary);
        margin-bottom: 10px;
    }

    .toggle-switch {
        position: relative;
        display: inline-block;
        width: 60px;
        height: 34px;
    }

    .toggle-switch input {
        opacity: 0;
        width: 0;
        height: 0;
    }

    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        transition: .4s;
        border-radius: 34px;
    }

    .slider:before {
        position: absolute;
        content: "";
        height: 26px;
        width: 26px;
        left: 4px;
        bottom: 4px;
        background-color: white;
        transition: .4s;
        border-radius: 50%;
    }

    input:checked + .slider {
        background-color: #2ecc71;
    }

    input:checked + .slider:before {
        transform: translateX(26px);
    }

    .feature-item {
        background: white;
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .notification-badge {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #e74c3c;
        color: white;
        padding: 15px 25px;
        border-radius: 50px;
        font-size: 1.2em;
        font-weight: bold;
        box-shadow: 0 5px 20px rgba(231, 76, 60, 0.5);
        animation: pulse 2s infinite;
        z-index: 9999;
        cursor: pointer;
    }

    @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
    }

    .order-link-box {
        background: white;
        padding: 25px;
        border-radius: 15px;
        margin-top: 20px;
    }

    .link-display {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 10px;
        border: 2px dashed var(--primary);
        word-break: break-all;
        margin: 15px 0;
        font-family: monospace;
        font-size: 0.9em;
    }

    @media print {
        body * {
            visibility: hidden;
        }
        .receipt, .receipt * {
            visibility: visible;
        }
        .receipt {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
        }
        .btn {
            display: none !important;
        }
    }

    @media (max-width: 968px) {
        .main-content {
            grid-template-columns: 1fr;
        }

        .products-section {
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        }

        .form-row {
            grid-template-columns: 1fr;
        }

        .stats-grid {
            grid-template-columns: 1fr;
        }
    }
    /* Login Screen Styles */
.login-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10000;
}

.login-screen.hidden {
    display: none;
}

.login-box {
    background: white;
    padding: 50px;
    border-radius: 20px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    text-align: center;
    max-width: 400px;
    width: 90%;
}

.login-title {
    font-size: 2.5em;
    color: var(--primary);
    margin-bottom: 20px;
}

.login-subtitle {
    color: #666;
    margin-bottom: 30px;
    font-size: 1.1em;
}

.login-input {
    width: 100%;
    padding: 15px;
    border: 2px solid #e0e0e0;
    border-radius: 10px;
    font-size: 1.2em;
    margin-bottom: 20px;
    text-align: center;
}

.login-input:focus {
    outline: none;
    border-color: var(--primary);
}

.login-btn {
    width: 100%;
    padding: 15px;
    background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
    color: white;
    border: none;
    border-radius: 10px;
    font-size: 1.3em;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
}

.login-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
}

</style>

</head>
<body>
    <!-- Login Screen -->
<div class="login-screen" id="loginScreen">
    <div class="login-box">
        <div class="login-title">ğŸ” ÙØ§Ø³Øª ÙÛ†Ø¯ ğŸ•</div>
        <div class="login-subtitle">ØªÚ©Ø§ÛŒÛ• Ù†Ø§ÙˆØª Ø¨Ù†ÙˆÙˆØ³Û•</div>
        <input type="text" class="login-input" id="loginName" placeholder="Ù†Ø§ÙˆØª Ù„ÛØ±Û• Ø¨Ù†ÙˆÙˆØ³Û•...">
        <button class="login-btn" onclick="handleLogin()">Ø¯Ø§Ø®Úµ Ø¨ÙˆÙˆÙ† â†</button>
    </div>
</div>
    <!-- Notification Badge -->
    <div class="notification-badge" id="notificationBadge" style="display: none;" onclick="goToOnlineOrders()">
        ğŸ”” <span id="newOrdersCount">0</span> Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ Ù†ÙˆÛ
    </div>
<div class="container">
    <div class="header">
        <div>
            <h1 id="appTitle">ğŸ” ÙØ§Ø³Øª ÙÛ†Ø¯ ğŸ•</h1>
            <p style="font-size: 1.2em;">Ø³ÛŒØ³ØªÛ•Ù…ÛŒ ÙØ±Û†Ø´ØªÙ† Ùˆ Ø¨Û•Ú•ÛÙˆÛ•Ø¨Ø±Ø¯Ù†</p>
        </div>
        <div class="mode-toggle">
            <button class="mode-btn active" id="customerBtn">ğŸ‘¤ Ú©Ú•ÛŒØ§Ø±</button>
            <button class="mode-btn" id="adminBtn">âš™ï¸ Ø¨Û•Ú•ÛÙˆÛ•Ø¨Ø±Ø¯Ù†</button>
        </div>
    </div>

    <!-- Customer View -->
    <div class="view active" id="customerView">
        <div class="category-filter" id="categoryFilter"></div>
        <div class="main-content">
            <div class="products-section" id="products"></div>
            
            <div class="cart-section">
                <div class="cart-title">ğŸ›’ Ø³Û•Ø¨Û•ØªÛ•</div>
                
                <div class="delivery-section">
                    <h4>ğŸš— Ø¬Û†Ø±ÛŒ ÙˆÛ•Ø±Ú¯Ø±ØªÙ†</h4>
                    <div class="delivery-option">
                        <input type="radio" name="delivery" id="pickup" value="pickup" checked>
                        <label for="pickup">ğŸª Ù„Û• Ø´ÙˆÛÙ†</label>
                        <input type="radio" name="delivery" id="delivery" value="delivery">
                        <label for="delivery">ğŸš— Ú¯Û•ÛŒØ§Ù†Ø¯Ù†</label>
                    </div>
                    <div id="addressField" style="display: none;">
                        <input type="text" class="form-control" id="deliveryAddress" placeholder="Ù†Ø§ÙˆÙ†ÛŒØ´Ø§Ù† Ø¨Ù†ÙˆÙˆØ³Û•" style="margin-bottom: 10px;">
                        <input type="text" class="form-control" id="deliveryLocation" placeholder="Ù„ÛŒÙ†Ú©ÛŒ Ù„Û†Ú©Û•ÛŒØ´Ù† (Google Maps)" style="margin-bottom: 10px;">
                        <input type="text" class="form-control" id="deliveryPhone" placeholder="Ú˜Ù…Ø§Ø±Û•ÛŒ Ù…Û†Ø¨Ø§ÛŒÙ„">
                        <p style="margin-top: 10px; color: var(--primary); font-weight: bold;">ØªÛÚ†ÙˆÙˆÙ†ÛŒ Ú¯Û•ÛŒØ§Ù†Ø¯Ù†: <span id="deliveryFee">2000</span> Ø¯ÛŒÙ†Ø§Ø±</p>
                    </div>
                    <div id="pickupPhoneField" style="display: none; margin-top: 10px;">
                        <input type="text" class="form-control" id="pickupPhone" placeholder="Ú˜Ù…Ø§Ø±Û•ÛŒ Ù…Û†Ø¨Ø§ÛŒÙ„">
                    </div>
                </div>

                <div class="cart-items" id="cartItems">
                    <div style="text-align: center; padding: 40px; color: #999;">
                        Ù‡ÛŒÚ† Ø¨Û•Ø±Ù‡Û•Ù…ÛÚ© Ø²ÛŒØ§Ø¯ Ù†Û•Ú©Ø±Ø§ÙˆÛ•
                    </div>
                </div>
                <div id="cartSummary" style="display: none;"></div>
                <button class="btn btn-primary" id="checkoutBtn" style="display: none;">ğŸ’° ØªÛ•ÙˆØ§ÙˆÚ©Ø±Ø¯Ù†ÛŒ Ú©Ú•ÛŒÙ†</button>
                <button class="btn btn-success" id="printReceiptBtn" style="display: none;">ğŸ–¨ï¸ Ú†Ø§Ù¾Ú©Ø±Ø¯Ù†ÛŒ ÙˆÛ•Ø³Úµ</button>
                <button class="btn btn-danger" id="clearBtn" style="display: none;">ğŸ—‘ï¸ Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ù‡Û•Ù…ÙˆÙˆ</button>
            </div>
        </div>
    </div>

    <!-- Admin View -->
    <div class="view" id="adminView">
        <div class="admin-container">
            <div class="admin-tabs">
                <button class="admin-tab active" data-tab="products">ğŸ“¦ Ø®ÙˆØ§Ø±Ø¯Ù†Û•Ú©Ø§Ù†</button>
                <button class="admin-tab" data-tab="add">â• Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†</button>
                <button class="admin-tab" data-tab="ingredients">ğŸ§ª Ù¾ÛÚ©Ù‡Ø§ØªÛ•Ú©Ø§Ù†</button>
                <button class="admin-tab" data-tab="analysis">ğŸ“Š Ø´ÛŒÚ©Ø§Ø±ÛŒ Ù‚Ø§Ø²Ø§Ù†Ø¬</button>
                <button class="admin-tab" data-tab="orders">ğŸ“‹ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒÛ•Ú©Ø§Ù†</button>
                <button class="admin-tab" data-tab="onlineOrders">ğŸŒ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ Ø¦Û†Ù†ÚµØ§ÛŒÙ†</button>
                <button class="admin-tab" data-tab="expenses">ğŸ’° Ø®Û•Ø±Ø¬ÛŒ Ùˆ Ù‚Ø§Ø²Ø§Ù†Ø¬</button>
                <button class="admin-tab" data-tab="categories">ğŸ“ Ø¨Û•Ø´Û•Ú©Ø§Ù†</button>
                <button class="admin-tab" data-tab="control">ğŸ›ï¸ Ú©Û†Ù†ØªØ±Û†Úµ</button>
                <button class="admin-tab" data-tab="settings">âš™ï¸ Ú•ÛÚ©Ø®Ø³ØªÙ†</button>
            </div>

            <!-- Products -->
            <div class="admin-content active" id="productsContent">
                <div class="admin-card">
                    <h3>ğŸ“¦ Ø¨Û•Ú•ÛÙˆÛ•Ø¨Ø±Ø¯Ù†ÛŒ Ø®ÙˆØ§Ø±Ø¯Ù†Û•Ú©Ø§Ù†</h3>
                    <div class="products-list" id="adminProductsList"></div>
                </div>
            </div>

            <!-- Add Product -->
            <div class="admin-content" id="addContent">
                <div class="admin-card">
                    <h3>â• Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ø®ÙˆØ§Ø±Ø¯Ù†ÛŒ Ù†ÙˆÛ</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Ù†Ø§ÙˆÛŒ Ø®ÙˆØ§Ø±Ø¯Ù†</label>
                            <input type="text" class="form-control" id="productName">
                        </div>
                        <div class="form-group">
                            <label>Ù†Ø±Ø® (Ø¯ÛŒÙ†Ø§Ø±)</label>
                            <input type="number" class="form-control" id="productPrice">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Ø¨Û•Ø´</label>
                            <select class="form-control" id="productCategory"></select>
                        </div>
                        <div class="form-group">
                            <label>Ú˜Ù…Ø§Ø±Û•ÛŒ Ø¨Û•Ø±Ø¯Û•Ø³Øª (Stock)</label>
                            <input type="number" class="form-control" id="productStock" value="100">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Ø¨Û•Ø³ØªÛ•Ø±ÛŒ ÙˆÛÙ†Û•</label>
                        <input type="url" class="form-control" id="productImage" placeholder="https://example.com/image.jpg">
                    </div>
                    <button class="btn btn-primary" id="addProductBtn">ğŸ’¾ Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†</button>
                </div>
            </div>

            <!-- Ingredients Management -->
            <div class="admin-content" id="ingredientsContent">
                <div class="admin-card">
                    <h3>ğŸ§ª Ø¨Û•Ú•ÛÙˆÛ•Ø¨Ø±Ø¯Ù†ÛŒ Ù¾ÛÚ©Ù‡Ø§ØªÛ•Ú©Ø§Ù†</h3>
                    <p style="color: #666; margin-bottom: 20px;">Ù¾ÛÚ©Ù‡Ø§ØªÛ•Ú©Ø§Ù†ÛŒ Ù‡Û•Ø± Ø®ÙˆØ§Ø±Ø¯Ù†ÛÚ© Ø¯ÛŒØ§Ø±ÛŒ Ø¨Ú©Û• Ø¨Û† Ø­ÛŒØ³Ø§Ø¨ÛŒ ØªÛÚ†ÙˆÙˆ Ùˆ Ù‚Ø§Ø²Ø§Ù†Ø¬</p>
                    
                    <div class="form-group">
                        <label>Ø®ÙˆØ§Ø±Ø¯Ù† Ù‡Û•ÚµØ¨Ú˜ÛØ±Û•</label>
                        <select class="form-control" id="ingredientProduct" onchange="showIngredients()"></select>
                    </div>

                    <div id="ingredientsSection" style="display: none;">
                        <h4 style="margin: 20px 0;">Ù¾ÛÚ©Ù‡Ø§ØªÛ•Ú©Ø§Ù†</h4>
                        <div id="ingredientsList"></div>
                        
                        <h4 style="margin: 30px 0 15px 0;">â• Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ù¾ÛÚ©Ù‡Ø§ØªÛ•ÛŒ Ù†ÙˆÛ</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Ù†Ø§ÙˆÛŒ Ù¾ÛÚ©Ù‡Ø§ØªÛ•</label>
                                <input type="text" class="form-control" id="ingredientName" placeholder="Ù…Û•Ø³Û•ÚµØ§: Ù¾Û•Ù†ÛŒØ±ØŒ Ú¯Û†Ø´Øª...">
                            </div>
                            <div class="form-group">
                                <label>Ø¨Ú•</label>
                                <input type="text" class="form-control" id="ingredientAmount" placeholder="Ù…Û•Ø³Û•ÚµØ§: Ù¡ Ú©ÛŒÙ„Û†ØŒ Ù¥Ù Ù  Ú¯Ø±Ø§Ù…">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Ù†Ø±Ø® (Ø¯ÛŒÙ†Ø§Ø±)</label>
                            <input type="number" class="form-control" id="ingredientCost">
                        </div>
                        <button class="btn btn-primary" onclick="addIngredient()">ğŸ’¾ Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†</button>
                    </div>
                </div>
            </div>

            <!-- Analysis -->
            <div class="admin-content" id="analysisContent">
                <div class="admin-card">
                    <h3>ğŸ“Š Ø´ÛŒÚ©Ø§Ø±ÛŒ Ù‚Ø§Ø²Ø§Ù†Ø¬ Ø¨Û† Ù‡Û•Ø± Ø®ÙˆØ§Ø±Ø¯Ù†ÛÚ©</h3>
                    
                    <div class="form-group">
                        <label>Ø®ÙˆØ§Ø±Ø¯Ù† Ù‡Û•ÚµØ¨Ú˜ÛØ±Û•</label>
                        <select class="form-control" id="analysisProduct" onchange="showAnalysis()"></select>
                    </div>

                    <div class="filter-buttons" style="margin: 20px 0;">
                        <button class="filter-btn active" data-period="today" onclick="changeAnalysisPeriod('today')">Ø¦Û•Ù…Ú•Û†</button>
                        <button class="filter-btn" data-period="week" onclick="changeAnalysisPeriod('week')">Ø¦Û•Ù… Ù‡Û•ÙØªÛ•ÛŒÛ•</button>
                        <button class="filter-btn" data-period="month" onclick="changeAnalysisPeriod('month')">Ø¦Û•Ù… Ù…Ø§Ù†Ú¯Û•</button>
                        <button class="filter-btn" data-period="all" onclick="changeAnalysisPeriod('all')">Ù‡Û•Ù…ÙˆÙˆ</button>
                    </div>

                    <div id="analysisResults"></div>
                </div>
            </div>

            <!-- Orders -->
            <div class="admin-content" id="ordersContent">
                <div class="admin-carâ€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹
d">
                        <h3>ğŸ“‹ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒÛ•Ú©Ø§Ù†</h3>
                        <div class="filter-buttons">
                            <button class="filter-btn active" data-filter="all">Ù‡Û•Ù…ÙˆÙˆ</button>
                            <button class="filter-btn" data-filter="today">Ø¦Û•Ù…Ú•Û†</button>
                            <button class="filter-btn" data-filter="week">Ø¦Û•Ù… Ù‡Û•ÙØªÛ•ÛŒÛ•</button>
                            <button class="filter-btn" data-filter="month">Ø¦Û•Ù… Ù…Ø§Ù†Ú¯Û•</button>
                        </div>
                        <div class="stats-grid" id="orderStats">
                            <div class="stat-card">
                                <div class="stat-number" id="totalOrdersCount">0</div>
                                <div>Ú©Û†ÛŒ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="totalOrdersValue">0</div>
                                <div>Ú©Û†ÛŒ ÙØ±Û†Ø´Ø±Ø§Ùˆ</div>
                            </div>
                        </div>
                        <div class="orders-list" id="ordersList"></div>
                    </div>
                </div>

                <!-- Online Orders -->
                <div class="admin-content" id="onlineOrdersContent">
                    <div class="admin-card">
                        <h3>ğŸŒ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ Ø¦Û†Ù†ÚµØ§ÛŒÙ†</h3>
                        <p style="color: #666; margin-bottom: 20px;">Ù„ÛŒÙ†Ú©ÛŒ Ø¦Û†Ù†ÚµØ§ÛŒÙ† Ø¦Û†Ø±Ø¯Û•Ø± Ø¨Û† Ù…Ø´ØªÛ•Ø±ÛŒÛ•Ú©Ø§Ù†Øª Ø¨Ù†ÛØ±Û•</p>
                        
                        <div class="order-link-box">
                            <h4 style="color: var(--primary); margin-bottom: 15px;">ğŸ”— Ù„ÛŒÙ†Ú©ÛŒ Ø¦Û†Ø±Ø¯Û•Ø±ÛŒ Ø¦Û†Ù†ÚµØ§ÛŒÙ†</h4>
                            <div class="link-display" id="orderLinkDisplay"></div>
                            <button class="btn btn-primary" onclick="copyOrderLink()">ğŸ“‹ Ú©Û†Ù¾ÛŒÚ©Ø±Ø¯Ù†ÛŒ Ù„ÛŒÙ†Ú©</button>
                        </div>

                        <h4 style="margin: 30px 0 15px 0;">ğŸ“¦ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒÛ• Ù†ÙˆÛÛŒÛ•Ú©Ø§Ù†</h4>
                        <div class="orders-list" id="onlineOrdersList"></div>
                    </div>
                </div>

                <!-- Expenses -->
                <div class="admin-content" id="expensesContent">
                    <div class="admin-card">
                        <h3>ğŸ’° Ø®Û•Ø±Ø¬ÛŒ Ùˆ Ù‚Ø§Ø²Ø§Ù†Ø¬</h3>
                        
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-number" id="totalRevenue" style="color: #2ecc71;">0</div>
                                <div>Ø¯Ø§Ù‡Ø§Øª (ÙØ±Û†Ø´ØªÙ†)</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="totalExpenses" style="color: #e74c3c;">0</div>
                                <div>Ø®Û•Ø±Ø¬ÛŒ</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="totalProfit" style="color: var(--primary);">0</div>
                                <div>Ù‚Ø§Ø²Ø§Ù†Ø¬</div>
                            </div>
                        </div>

                        <h4 style="margin: 30px 0 15px 0;">â• Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ÛŒ Ø®Û•Ø±Ø¬ÛŒ</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Ø¬Û†Ø±ÛŒ Ø®Û•Ø±Ø¬ÛŒ</label>
                                <input type="text" class="form-control" id="expenseType" placeholder="Ù…Û•Ø³Û•ÚµØ§: Ú©Ø±ÛÛŒ Ø´ÙˆÛÙ†">
                            </div>
                            <div class="form-group">
                                <label>Ø¨Ú•ÛŒ Ù¾Ø§Ø±Û• (Ø¯ÛŒÙ†Ø§Ø±)</label>
                                <input type="number" class="form-control" id="expenseAmount">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>ØªØ§ÛŒØ¨Û•ØªÛ• Ø¨Û• Ø®ÙˆØ§Ø±Ø¯Ù†ÛÚ©ÛŒ Ø¯ÛŒØ§Ø±ÛŒÚ©Ø±Ø§ÙˆØŸ (Ø¯ÚµØ®ÙˆØ§Ø²)</label>
                            <select class="form-control" id="expenseProduct">
                                <option value="">Ù‡ÛŒÚ†Ú©Ø§Ù… - Ø®Û•Ø±Ø¬ÛŒ Ú¯Ø´ØªÛŒ</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" id="addExpenseBtn">ğŸ’¾ Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†</button>

                        <h4 style="margin: 30px 0 15px 0;">ğŸ“‹ Ù„ÛŒØ³ØªÛŒ Ø®Û•Ø±Ø¬ÛŒÛŒÛ•Ú©Ø§Ù†</h4>
                        <div class="expenses-list" id="expensesList"></div>
                    </div>
                </div>

                <!-- Categories -->
                <div class="admin-content" id="categoriesContent">
                    <div class="admin-card">
                        <h3>ğŸ“ Ø¨Û•Ú•ÛÙˆÛ•Ø¨Ø±Ø¯Ù†ÛŒ Ø¨Û•Ø´Û•Ú©Ø§Ù†</h3>
                        <div class="form-group">
                            <label>Ø¨Û•Ø´ÛŒ Ù†ÙˆÛ</label>
                            <div style="display: flex; gap: 10px;">
                                <input type="text" class="form-control" id="newCategory">
                                <button class="btn btn-primary" id="addCategoryBtn" style="white-space: nowrap; width: auto;">Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†</button>
                            </div>
                        </div>
                        <div id="categoriesList"></div>
                    </div>
                </div>

                <!-- Control Panel -->
                <div class="admin-content" id="controlContent">
                    <div class="admin-card">
                        <h3>ğŸ›ï¸ Ú©Û†Ù†ØªØ±Û†ÚµÛŒ ØªØ§ÛŒØ¨Û•ØªÙ…Û•Ù†Ø¯ÛŒÛŒÛ•Ú©Ø§Ù†</h3>
                        <p style="color: #666; margin-bottom: 20px;">Ù‡Û•Ø± ØªØ§ÛŒØ¨Û•ØªÙ…Û•Ù†Ø¯ÛŒÛŒÛ•Ú© Ø¨Û• ON/OFF Ø¨Ú©Û•</p>
                        
                        <div id="featuresList">
                            <div class="feature-item">
                                <div>
                                    <h4 style="margin-bottom: 5px;">ğŸ“¦ Ø¨Û•Ú•ÛÙˆÛ•Ø¨Ø±Ø¯Ù†ÛŒ Ø®ÙˆØ§Ø±Ø¯Ù†Û•Ú©Ø§Ù†</h4>
                                    <p style="color: #666; font-size: 0.9em;">Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù†ØŒ Ø¯Û•Ø³ØªÚ©Ø§Ø±ÛŒ Ùˆ Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ø®ÙˆØ§Ø±Ø¯Ù†Û•Ú©Ø§Ù†</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="feature_products" checked onchange="toggleFeature('products')">
                                    <span class="slider"></span>
                                </label>
                            </div>

                            <div class="feature-item">
                                <div>
                                    <h4 style="margin-bottom: 5px;">ğŸ§ª Ù¾ÛÚ©Ù‡Ø§ØªÛ•Ú©Ø§Ù†</h4>
                                    <p style="color: #666; font-size: 0.9em;">Ø¨Û•Ú•ÛÙˆÛ•Ø¨Ø±Ø¯Ù†ÛŒ Ù¾ÛÚ©Ù‡Ø§ØªÛ•Ú©Ø§Ù†ÛŒ Ø®ÙˆØ§Ø±Ø¯Ù†</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="feature_ingredients" checked onchange="toggleFeature('ingredients')">
                                    <span class="slider"></span>
                                </label>
                            </div>

                            <div class="feature-item">
                                <div>
                                    <h4 style="margin-bottom: 5px;">ğŸ“Š Ø´ÛŒÚ©Ø§Ø±ÛŒ Ù‚Ø§Ø²Ø§Ù†Ø¬</h4>
                                    <p style="color: #666; font-size: 0.9em;">Ø´ÛŒÚ©Ø§Ø±ÛŒ Ù‚Ø§Ø²Ø§Ù†Ø¬ Ø¨Û† Ù‡Û•Ø± Ø®ÙˆØ§Ø±Ø¯Ù†ÛÚ©</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="feature_analysis" checked onchange="toggleFeature('analysis')">
                                    <span class="slider"></span>
                                </label>
                            </div>

                            <div class="feature-item">
                                <div>
                                    <h4 style="margin-bottom: 5px;">ğŸ“‹ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒÛ•Ú©Ø§Ù†</h4>
                                    <p style="color: #666; font-size: 0.9em;">Ø¨ÛŒÙ†ÛŒÙ† Ùˆ Ø¯Û•Ø³ØªÚ©Ø§Ø±ÛŒÚ©Ø±Ø¯Ù†ÛŒ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒÛ•Ú©Ø§Ù†</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="feature_orders" checked onchange="toggleFeature('orders')">
                                    <span class="slider"></span>
                                </label>
                            </div>

                            <div class="feature-item">
                                <div>
                                    <h4 style="margin-bottom: 5px;">ğŸŒ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ Ø¦Û†Ù†ÚµØ§ÛŒÙ†</h4>
                                    <p style="color: #666; font-size: 0.9em;">Ù„ÛŒÙ†Ú©ÛŒ Ø¦Û†Ø±Ø¯Û•Ø± Ø¨Û† Ù…Ø´ØªÛ•Ø±ÛŒØ§Ù†</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="feature_onlineOrders" checked onchange="toggleFeature('onlineOrders')">
                                    <span class="slider"></span>
                                </label>
                            </div>

                            <div class="feature-item">
                                <div>
                                    <h4 style="margin-bottom: 5px;">ğŸ’° Ø®Û•Ø±Ø¬ÛŒ Ùˆ Ù‚Ø§Ø²Ø§Ù†Ø¬</h4>
                                    <p style="color: #666; font-size: 0.9em;">Ø¨Û•Ú•ÛÙˆÛ•Ø¨Ø±Ø¯Ù†ÛŒ Ø®Û•Ø±Ø¬ÛŒ Ùˆ Ù‚Ø§Ø²Ø§Ù†Ø¬</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="feature_expenses" checked onchange="toggleFeature('expenses')">
                                    <span class="slider"></span>
                                </label>
                            </div>

                            <div class="feature-item">
                                <div>
                                    <h4 style="margin-bottom: 5px;">ğŸ“ Ø¨Û•Ø´Û•Ú©Ø§Ù†</h4>
                                    <p style="color: #666; font-size: 0.9em;">Ø²ÛŒØ§Ø¯Ú©Ø±Ø¯Ù† Ùˆ Ø¨Û•Ú•ÛÙˆÛ•Ø¨Ø±Ø¯Ù†ÛŒ Ø¨Û•Ø´Û•Ú©Ø§Ù†</p>
                                </div>
                                <label class="toggle-switch">
                                    <input type="checkbox" id="feature_categories" checked onchange="toggleFeature('categories')">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings -->
                <div class="admin-content" id="settingsContent">
                    <div class="admin-card">
                        <h3>âš™ï¸ Ú•ÛÚ©Ø®Ø³ØªÙ†Û•Ú©Ø§Ù†</h3>
                        <div class="form-group">
                            <label>Ù†Ø§ÙˆÛŒ Ú†ÛØ´ØªØ®Ø§Ù†Û•</label>
                            <input type="text" class="form-control" id="restaurantName" value="ÙØ§Ø³Øª ÙÛ†Ø¯">
                        </div>
                        <div class="form-group">
                            <label>ØªÛÚ†ÙˆÙˆÙ†ÛŒ Ú¯Û•ÛŒØ§Ù†Ø¯Ù† (Ø¯ÛŒÙ†Ø§Ø±)</label>
                            <input type="number" class="form-control" id="deliveryFeeInput" value="2000">
                        </div>
                        <div class="form-group">
                            <label>Ø¦Ø§Ú¯Ø§Ø¯Ø§Ø±ÛŒ Ú©Û•Ù…Ø¨ÙˆÙˆÙ†Û•ÙˆÛ•ÛŒ Ù…Û•Ø®Ø²Û•Ù† (Stock) Ú©Ø§ØªÛÚ© Ø¨Ú•ÛŒ Ú©Û•Ù…ØªØ± Ø¨ÛØª Ù„Û•:</label>
                            <input type="number" class="form-control" id="stockAlert" value="10">
                        </div>
                        <button class="btn btn-primary" id="saveSettingsBtn">ğŸ’¾ Ù¾Ø§Ø´Û•Ú©Û•ÙˆØªÚ©Ø±Ø¯Ù†</button>
                        <button class="btn btn-danger" id="resetBtn">ğŸ”„ Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ù‡Û•Ù…ÙˆÙˆ Ø¯Ø§ØªØ§</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Receipt Modal -->
    <div class="modal" id="receiptModal">
        <div class="modal-content">
            <div class="receipt" id="receiptContent"></div>
            <button class="btn btn-danger" style="margin-top: 20px;" onclick="closeReceipt()">Ø¯Ø§Ø®Ø³ØªÙ†</button>
        </div>
    </div>

    <!-- Edit Order Modal -->
    <div class="modal" id="editOrderModal">
        <div class="modal-content">
            <h3 style="color: var(--primary); margin-bottom: 20px;">âœï¸ Ø¯Û•Ø³ØªÚ©Ø§Ø±ÛŒÚ©Ø±Ø¯Ù†ÛŒ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ</h3>
            <input type="hidden" id="editOrderId">
            
            <div class="form-group">
                <label>Ø¬Û†Ø±ÛŒ ÙˆÛ•Ø±Ú¯Ø±ØªÙ†</label>
                <div class="delivery-option">
                    <input type="radio" name="editDelivery" id="editPickup" value="pickup">
                    <label for="editPickup">ğŸª Ù„Û• Ø´ÙˆÛÙ†</label>
                    <input type="radio" name="editDelivery" id="editDelivery" value="delivery">
                    <label for="editDelivery">ğŸš— Ú¯Û•ÛŒØ§Ù†Ø¯Ù†</label>
                </div>
            </div>
            
            <div class="form-group" id="editAddressField" style="display: none;">
                <label>Ù†Ø§ÙˆÙ†ÛŒØ´Ø§Ù†</label>
                <input type="text" class="form-control" id="editOrderAddress">
            </div>
            
            <div class="form-group">
                <label>Ø®ÙˆØ§Ø±Ø¯Ù†Û•Ú©Ø§Ù†</label>
                <div id="editOrderItems"></div>
            </div>
            
            <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-top: 20px;">
                <div style="display: flex; justify-content: space-between; padding: 5px 0;">
                    <span>Ú©Û†ÛŒ Ø®ÙˆØ§Ø±Ø¯Ù†:</span>
                    <span id="editSubtotal">0 Ø¯ÛŒÙ†Ø§Ø±</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 5px 0;" id="editDeliveryFeeRow">
                    <span>ØªÛÚ†ÙˆÙˆÙ†ÛŒ Ú¯Û•ÛŒØ§Ù†Ø¯Ù†:</span>
                    <span id="editDeliveryFeeAmount">0 Ø¯ÛŒÙ†Ø§Ø±</span>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 10px 0; font-size: 1.3em; font-weight: bold; color: var(--primary); border-top: 2px solid var(--primary); margin-top: 10px;">
                    <span>Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ:</span>
                    <span id="editTotal">0 Ø¯ÛŒÙ†Ø§Ø±</span>
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="saveOrderEdit()">ğŸ’¾ Ù¾Ø§Ø´Û•Ú©Û•ÙˆØªÚ©Ø±Ø¯Ù†</button>
            <button class="btn btn-danger" onclick="closeEditOrderModal()">Ø¯Ø§Ø®Ø³ØªÙ†</button>
        </div>
    </div>

    <!-- Edit Product Modal -->
    <div class="modal" id="editModal">
        <div class="modal-content">
            <h3 style="color: var(--primary); margin-bottom: 20px;">âœï¸ Ø¯Û•Ø³ØªÚ©Ø§Ø±ÛŒÚ©Ø±Ø¯Ù†</h3>
            <input type="hidden" id="editProductId">
            <div class="form-group">
                <label>Ù†Ø§ÙˆÛŒ Ø®ÙˆØ§Ø±Ø¯Ù†</label>
                <input type="text" class="form-control" id="editProductName">
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>Ù†Ø±Ø® (Ø¯ÛŒÙ†Ø§Ø±)</label>
                    <input type="number" class="form-control" id="editProductPrice">
                </div>
                <div class="form-group">
                    <label>Ú˜Ù…Ø§Ø±Û•ÛŒ Ø¨Û•Ø±Ø¯Û•Ø³Øª</label>
                    <input type="number" class="form-control" id="editProductStock">
                </div>
            </div>
            <div class="form-group">
                <label>Ø¨Û•Ø´</label>
                <select class="form-control" id="editProductCategory"></select>
            </div>
            <div class="form-group">
                <label>Ø¨Û•Ø³ØªÛ•Ø±ÛŒ ÙˆÛÙ†Û•</label>
                <input type="url" class="form-control" id="editProductImage">
            </div>
            <button class="btn btn-primary" id="updateProductBtn">ğŸ’¾ Ù¾Ø§Ø´Û•Ú©Û•ÙˆØªÚ©Ø±Ø¯Ù†</button>
            <button class="btn btn-danger" onclick="closeEditModal()">Ø¯Ø§Ø®Ø³ØªÙ†</button>
        </div>
    </div>

    <script>
    let currentUser = null;
const OWNER_NAME = 'shakar12121';

function handleLogin() {
    const name = document.getElementById('loginName').value.trim();
    
    if (!name) {
        alert('âŒ ØªÚ©Ø§ÛŒÛ• Ù†Ø§ÙˆØª Ø¨Ù†ÙˆÙˆØ³Û•!');
        return;
    }
    
    // Check role
    let role = 'member'; // Default
    
    if (name.toLowerCase() === OWNER_NAME.toLowerCase()) {
        role = 'owner';
    }
    
    // Check if user is admin
    const users = JSON.parse(localStorage.getItem('users') || '[]');
    const existingUser = users.find(u => u.name.toLowerCase() === name.toLowerCase());
    
    if (existingUser) {
        role = existingUser.role;
    } else {
        // Add new user
        users.push({ name: name, role: role, joinDate: new Date().toISOString() });
        localStorage.setItem('users', JSON.stringify(users));
    }
    
    currentUser = { name: name, role: role };
    localStorage.setItem('currentUser', JSON.stringify(currentUser));
    
    // Hide login screen
    document.getElementById('loginScreen').classList.add('hidden');
    
    // Apply role permissions
    applyRolePermissions();
}

function applyRolePermissions() {
    if (!currentUser) return;
    
    if (currentUser.role === 'member') {
        // Member: only customer view
        document.getElementById('adminBtn').style.display = 'none';
        switchMode('customer');
    } else {
        // Owner/Admin: show all
        document.getElementById('adminBtn').style.display = 'block';
    }
}

function checkExistingLogin() {
    const saved = localStorage.getItem('currentUser');
    if (saved) {
        currentUser = JSON.parse(saved);
        document.getElementById('loginScreen').classList.add('hidden');
        applyRolePermissions();
    }
}

        let data = {
            products: [],
            categories: ['Ù‡Û•Ù…ÙˆÙˆ', 'Ø®ÙˆØ§Ø±Ø¯Ù†', 'Ø®ÙˆØ§Ø±Ø¯Ù†Û•ÙˆÛ•', 'Ø¯Û•Ø³Û•Ø±Øª'],
            orders: [],
            onlineOrders: [],
            expenses: [],
            cart: {},
            currentCategory: 'Ù‡Û•Ù…ÙˆÙˆ',
            currentFilter: 'all',
            settings: {
                name: 'ÙØ§Ø³Øª ÙÛ†Ø¯',
                deliveryFee: 2000,
                stockAlert: 10
            },
            features: {
                products: true,
                ingredients: true,
                analysis: true,
                orders: true,
                onlineOrders: true,
                expenses: true,
                categories: true
            }
        };

        let currentAnalysisPeriod = 'all';
        let currentOrder = null;
        let lastCheckedOrderCount = 0;

        function loadData() {
            try {
                const savedProducts = localStorage.getItem('products');
                if (savedProducts) {
                    data.products = JSON.parse(savedProducts);
                    data.products.forEach(p => {
                        if (!p.ingredients) p.ingredients = [];
                    });
                }
                
                const savedCategories = localStorage.getItem('categories');
                if (savedCategories) data.categories = JSON.parse(savedCategories);
                
                const savedOrders = localStorage.getItem('orders');
                if (savedOrders) data.orders = JSON.parse(savedOrders);
                
                const savedOnlineOrders = localStorage.getItem('onlineOrders');
                if (savedOnlineOrders) data.onlineOrders = JSON.parse(savedOnlineOrders);
                
                const savedExpenses = localStorage.getItem('expenses');
                if (savedExpenses) data.expenses = JSON.parse(savedExpenses);
                
                const savedSettings = localStorage.getItem('settings');
                if (savedSettings) data.settings = JSON.parse(savedSettings);
                
                const savedFeatures = localStorage.getItem('features');
                if (savedFeatures) data.features = JSON.parse(savedFeatures);
                
                if (data.products.length === 0) {
                    data.products = [
                        { id: 1, name: 'Ø¨Ø±Ú¯Ø±', price: 3500, category: 'Ø®ÙˆØ§Ø±Ø¯Ù†', stock: 50, ingredients: [], image: 'https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=400' },
                        { id: 2, name: 'Ù¾ÛŒØªØ²Ø§', price: 6000, category: 'Ø®ÙˆØ§Ø±Ø¯Ù†', stock: 30, ingredients: [], image: 'https://images.unsplash.com/photo-1513104890138-7c749659a591?w=400' },
                        { id: 3, name: 'Ú©Û†Ú©Ø§', price: 1000, category: 'Ø®ÙˆØ§Ø±Ø¯Ù†Û•ÙˆÛ•', stock: 100, ingredients: [], image: 'https://images.unsplash.com/photo-1554866585-cd94860890b7?w=400' }
                    ];
                    save();
                }

                lastCheckedOrderCount = data.onlineOrders.length;
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }

        function save() {
            localStorage.setItem('products', JSON.stringify(data.products));
            localStorage.setItem('categories', JSON.stringify(data.categories));
            localStorage.setItem('orders', JSON.stringify(data.orders));
            localStorage.setItem('onlineOrders', JSON.stringify(data.onlineOrders));
            localStorage.setItem('expenses', JSON.stringify(data.expenses));
            localStorage.setItem('settings', JSON.stringify(data.settings));
            localStorage.setItem('features', JSON.stringify(data.features));
        }

        function toggleFeature(feature) {
            data.features[feature] = document.getElementById('feature_' + feature).checked;
            save();
            updateAdminTabs();
        }

        function updateAdminTabs() {
            const tabMap = {
                'products': 'products',
                'ingredients': 'ingredients',
                'analysis': 'analysis',
                'orders': 'orders',
                'onlineOrders': 'onlineOrders',
                'expenses': 'expenses',
                'categories': 'categories'
            };

            Object.keys(tabMap).forEach(feature => {
                const tab = document.querySelector(`[data-tab="${tabMap[feature]}"]`);
                if (tab) {
                    if (data.features[feature]) {
                        tab.style.display = 'block';
                    } else {
                        tab.style.display = 'none';
                    }
                }
            });
        }

        function getOrderLink() {
            const baseUrl = window.location.href.split('?')[0].split('#')[0];
            return baseUrl + '?mode=order';
        }

        function copyOrderLink() {
            const link = getOrderLink();
            navigator.clipboard.writeText(link).then(() => {
                alert('âœ… Ù„ÛŒÙ†Ú© Ú©Û†Ù¾ÛŒ Ú©Ø±Ø§!\n' + link);
            }).catch(() => {
                alert('Ù„ÛŒÙ†Ú©: ' + link);
            });
        }

        function checkForOnlineMode() {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('mode') === 'order') {
                switchMode('customer');
                document.getElementById('adminBtn').style.display = 'none';
            }
        }

        function checkNewOrders() {
            const currentCount = data.onlineOrders.length;
            if (currentCount > lastCheckedOrderCount) {
                const newOrders = currentCount - lastCheckedOrderCount;
                showNotification(newOrders);
                playNotificationSound();
                lastCheckedOrderCount = currentCount;
            }
        }

        function showNotification(count) {
            const badge = document.getElementById('notificationBadge');
            document.getElementById('newOrdersCount').textContent = count;
            badge.style.display = 'block';
            
            setTimeout(() => {
                badge.style.display = 'none';
            }, 10000);
        }

        function playNotificationSound() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 800;
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);
        }

        function goToOnlineOrders() {
            switchMode('admin');
            switchAdminTab('onlineOrders');
            document.getElementById('notificationBadge').style.display = 'none';
        }

        function showOnlineOrders() {
            const link = getOrderLink();
            document.getElementById('orderLinkDisplay').textContent = link;

            const list = document.getElementById('onlineOrdersList');
            if (data.onlineOrders.length === 0) {
                list.innerHTML = '<div style="text-align: center; padding: 40px; color: #999;">Ù‡ÛŒÚ† Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒÛŒÛ•Ú© Ù†ÛŒÛŒÛ•</div>';
                return;
            }

            list.innerHTML = data.onlineOrders.reverse().map(order => `
                <div class="order-item">
                    <div class="order-header">
                        <div>
                            <div class="order-number">#${order.number.toString().padStart(4, '0')}</div>
                            <div class="order-date">
                                ${new Date(order.date).toLocaleDateString('ar-IQ')} - 
                                ${new Date(order.date).toLocaleTimeString('ar-IQ')}
                            </div>
                        </div>
                        <div style="text-align: left;">
                            <div style="font-weight: bold;">${order.deliveryType}</div>
                            ${order.phone ? `<div style="font-size: 0.9em; color: #666;">ğŸ“± ${order.phone}</div>` : ''}
                            ${order.deliveryType === 'Ú¯Û•ÛŒØ§Ù†Ø¯Ù†' ? `
                                <div style="font-size: 0.9em; color: #666;">ğŸ“ ${order.address}</div>
                                ${order.location ? `<a href="${order.location}" target="_blank" style="font-size: 0.9em; color: var(--primary);">ğŸ—ºï¸ Ù„Û†Ú©Û•ÛŒØ´Ù†</a>` : ''}
                            ` : ''}
                        </div>
                    </div>
                    <div class="order-items">
                        ${order.items.map(item => `
                            <div class="order-item-row">
                                <span>${item.name} Ã— ${item.quantity}</span>
                                <span>${(item.price * item.quantity).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</span>
                            </div>
                        `).join('')}
                    </div>
                    <div class="order-total">
                        <span>Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ:</span>
                        <span>${order.total.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</span>
                    </div>
                    <div class="order-actions">
                        <button class="btn-small btn-edit" onclick="viewOnlineOrder(${order.id})">ğŸ‘ï¸ Ø¨ÛŒÙ†ÛŒÙ†</button>
                        <button class="btn-small btn-delete" onclick="deleteOnlineOrder(${order.id})">ğŸ—‘ï¸ Ø³Ú•ÛŒÙ†Û•ÙˆÛ•</button>
                    </div>
                </div>
            `).join('');
        }

        function viewOnlineOrder(id) {
            const order = data.onlineOrders.find(o => o.id === id);
            showReceipt(order);
        }

        function deleteOnlineOrder(id) {
            if (confirm('Ø¯ÚµÙ†ÛŒØ§ÛŒØª Ù„Û• Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ø¦Û•Ù… Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒÛ•ØŸ')) {
                data.onlineOrders = data.onlineOrders.filter(o => o.id !== id);
                save();
                showOnlineOrders();
            }
        }

        function showIngredients() {
            const productId = parseInt(document.getElementById('ingredientProduct').value);
            if (!productId) {
                document.getElementById('ingredientsSection').style.display = 'none';
                return;
            }

            const product = data.products.find(p => p.id === productId);
            if (!product.ingredients) product.ingredients = [];

            document.getElementById('ingredientsSection').style.display = 'block';

            const total = product.ingredients.reduce((s, i) => s + i.cost, 0);

            document.getElementById('ingredientsList').innerHTML = `
                <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    ${product.ingredients.length === 0 ? 
                        '<p style="text-align: center; color: #999;">Ù‡ÛŒÚ† Ù¾ÛÚ©Ù‡Ø§ØªÛ•ÛŒÛ•Ú© Ø²ÛŒØ§Ø¯ Ù†Û•Ú©Ø±Ø§ÙˆÛ•</p>' :
                        product.ingredients.map((ing, idx) => `
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #f0f0f0;">
                                <div>
                                    <div style="font-weight: bold;">${ing.name}</div>
                                    <div style="color: #666; font-size: 0.9em;">${ing.amount}</div>
                                </div>
                                <div style="display: flex; gap: 10px; align-items: center;">
                                    <div style="font-weight: bold; color: var(--primary);">${ing.cost.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</div>
                                    <button class="btn-small btn-delete" onclick="removeIngredient(${productId}, ${idx})">Ã—</button>
                                </div>
                            </div>
                        `).join('')
                    }
                    <div style="display: flex; justify-content: space-between; padding-top: 15px; margin-top: 15px; border-top: 2px solid var(--primary); font-size: 1.2em; font-weight: bold; color: var(--primary);">
                        <span>Ú©Û†ÛŒ ØªÛÚ†ÙˆÙˆ:</span>
                        <span>${total.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</span>
                    </div>
                </div>
            `;
        }

        function addIngredient() {
            const productId = parseInt(document.getElementById('ingredientProduct').value);
            const name = document.getElementById('ingredientName').value.trim();
            const amount = document.getElementById('ingredientAmount').value.trim();
            const cost = parseInt(document.getElementById('ingredientCost').value);

            if (!productId || !name || !amount || !cost || cost <= 0) {
                alert('âŒ ØªÚ©Ø§ÛŒÛ• Ù‡Û•Ù…ÙˆÙˆ Ø®Ø§Ù†Û•Ú©Ø§Ù† Ù¾Ú•Ø¨Ú©Û•Ø±Û•ÙˆÛ•!');
                return;
            }

            const product = data.products.find(p => p.id === productId);
            if (!product.ingredients) product.ingredients = [];

            product.ingredients.push({ name, amount, cost });

            save();
            showIngredients();

            document.getElementById('ingredientName').value = '';
            document.getElementById('ingredientAmount').value = '';
            document.getElementById('ingredientCost').value = '';

            alert('âœ… Ù¾ÛÚ©Ù‡Ø§ØªÛ• Ø²ÛŒØ§Ø¯Ú©Ø±Ø§!');
        }

        function removeIngredient(productId, index) {
            if (!confirm('Ø¯ÚµÙ†ÛŒØ§ÛŒØª Ù„Û• Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ø¦Û•Ù… Ù¾ÛÚ©Ù‡Ø§ØªÛ•ÛŒÛ•ØŸ')) return;

            const product = data.products.find(p => p.id === productId);
            product.ingredients.splice(index,1)
           save();
            showIngredients();
        }

        function showAnalysis() {
            const productId = parseInt(document.getElementById('analysisProduct').value);
            if (!productId) {
                document.getElementById('analysisResults').innerHTML = '';
                return;
            }

            calculateAnalysis(productId);
        }

        function changeAnalysisPeriod(period) {
            currentAnalysisPeriod = period;
            document.querySelectorAll('[data-period]').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-period="${period}"]`).classList.add('active');

            const productId = parseInt(document.getElementById('analysisProduct').value);
            if (productId) calculateAnalysis(productId);
        }

        function calculateAnalysis(productId) {
            const product = data.products.find(p => p.id === productId);
            if (!product) return;

            let filteredOrders = data.orders;
            const now = new Date();

            if (currentAnalysisPeriod === 'today') {
                filteredOrders = data.orders.filter(o => {
                    const orderDate = new Date(o.date);
                    return orderDate.toDateString() === now.toDateString();
                });
            } else if (currentAnalysisPeriod === 'week') {
                const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                filteredOrders = data.orders.filter(o => new Date(o.date) >= weekAgo);
            } else if (currentAnalysisPeriod === 'month') {
                const monthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
                filteredOrders = data.orders.filter(o => new Date(o.date) >= monthAgo);
            }

            let soldQuantity = 0;
            filteredOrders.forEach(order => {
                order.items.forEach(item => {
                    if (item.id === productId) {
                        soldQuantity += item.quantity;
                    }
                });
            });

            const ingredientsCost = product.ingredients ? product.ingredients.reduce((s, i) => s + i.cost, 0) : 0;
            const costPerUnit = ingredientsCost;
            const totalCost = costPerUnit * soldQuantity;
            const revenue = product.price * soldQuantity;
            const profit = revenue - totalCost;
            const profitPerUnit = product.price - costPerUnit;
            const profitMargin = revenue > 0 ? ((profit / revenue) * 100).toFixed(1) : 0;

            const periodText = {
                'today': 'Ø¦Û•Ù…Ú•Û†',
                'week': 'Ø¦Û•Ù… Ù‡Û•ÙØªÛ•ÛŒÛ•',
                'month': 'Ø¦Û•Ù… Ù…Ø§Ù†Ú¯Û•',
                'all': 'Ù‡Û•Ù…ÙˆÙˆ Ú©Ø§Øª'
            }[currentAnalysisPeriod];

            document.getElementById('analysisResults').innerHTML = `
                <div style="background: white; padding: 30px; border-radius: 15px;">
                    <h4 style="color: var(--primary); margin-bottom: 20px;">Ú•Ø§Ù¾Û†Ø±ØªÛŒ: ${product.name} (${periodText})</h4>
                    
                    <div class="stats-grid" style="margin-bottom: 30px;">
                        <div class="stat-card">
                            <div class="stat-number">${soldQuantity}</div>
                            <div>Ú˜Ù…Ø§Ø±Û•ÛŒ ÙØ±Û†Ø´Ø±Ø§Ùˆ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" style="color: #e74c3c;">${costPerUnit.toLocaleString()}</div>
                            <div>ØªÛÚ†ÙˆÙˆÛŒ ÛŒÛ•Ú© Ø¯Ø§Ù†Û•</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" style="color: #2ecc71;">${product.price.toLocaleString()}</div>
                            <div>Ù†Ø±Ø®ÛŒ ÙØ±Û†Ø´ØªÙ†</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" style="color: ${profitPerUnit >= 0 ? '#2ecc71' : '#e74c3c'};">${profitPerUnit.toLocaleString()}</div>
                            <div>Ù‚Ø§Ø²Ø§Ù†Ø¬ÛŒ ÛŒÛ•Ú© Ø¯Ø§Ù†Û•</div>
                        </div>
                    </div>

                    <h4 style="margin: 30px 0 15px 0;">Ù¾ÛÚ©Ù‡Ø§ØªÛ•Ú©Ø§Ù†:</h4>
                    ${product.ingredients && product.ingredients.length > 0 ? `
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                            ${product.ingredients.map(ing => `
                                <div style="display: flex; justify-content: space-between; padding: 8px 0;">
                                    <div>${ing.name} (${ing.amount})</div>
                                    <div style="font-weight: bold;">${ing.cost.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</div>
                                </div>
                            `).join('')}
                            <div style="display: flex; justify-content: space-between; padding-top: 10px; margin-top: 10px; border-top: 2px solid #ddd; font-weight: bold; color: var(--primary);">
                                <div>Ú©Û†ÛŒ ØªÛÚ†ÙˆÙˆ:</div>
                                <div>${ingredientsCost.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</div>
                            </div>
                        </div>
                    ` : '<p style="text-align: center; color: #999; padding: 20px;">Ù‡ÛŒÚ† Ù¾ÛÚ©Ù‡Ø§ØªÛ•ÛŒÛ•Ú© Ø¯ÛŒØ§Ø±ÛŒ Ù†Û•Ú©Ø±Ø§ÙˆÛ•</p>'}

                    <h4 style="margin: 30px 0 15px 0;">Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ:</h4>
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                        <div style="display: flex; justify-content: space-between; padding: 8px 0; font-size: 1.1em;">
                            <div>Ú©Û†ÛŒ Ø¯Ø§Ù‡Ø§Øª (ÙØ±Û†Ø´ØªÙ†):</div>
                            <div style="font-weight: bold; color: #2ecc71;">${revenue.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</div>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 8px 0; font-size: 1.1em;">
                            <div>Ú©Û†ÛŒ Ø®Û•Ø±Ø¬ÛŒ:</div>
                            <div style="font-weight: bold; color: #e74c3c;">${totalCost.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</div>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 15px 0; margin-top: 10px; border-top: 3px solid var(--primary); font-size: 1.5em;">
                            <div style="font-weight: bold;">Ù‚Ø§Ø²Ø§Ù†Ø¬/Ø²Û•Ø±Û•Ø±:</div>
                            <div style="font-weight: bold; color: ${profit >= 0 ? '#2ecc71' : '#e74c3c'};">
                                ${profit >= 0 ? '+' : ''}${profit.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 15px; padding-top: 15px; border-top: 1px solid #ddd;">
                            <div style="font-size: 0.9em; color: #666;">Ú•ÛÚ˜Û•ÛŒ Ù‚Ø§Ø²Ø§Ù†Ø¬:</div>
                            <div style="font-size: 2em; font-weight: bold; color: ${profit >= 0 ? '#2ecc71' : '#e74c3c'};">
                                ${profitMargin}%
                            </div>
                        </div>
                    </div>

                    ${soldQuantity === 0 ? `
                        <div style="background: #fff3cd; padding: 15px; border-radius: 10px; margin-top: 20px; text-align: center; color: #856404;">
                            âš ï¸ Ù‡ÛŒÚ† ÙØ±Û†Ø´ØªÙ†ÛÚ© Ù†ÛŒÛŒÛ• Ø¨Û† Ø¦Û•Ù… Ù…Ø§ÙˆÛ•ÛŒÛ•
                        </div>
                    ` : ''}

                    ${profit < 0 ? `
                        <div style="background: #f8d7da; padding: 15px; border-radius: 10px; margin-top: 20px; text-align: center; color: #721c24;">
                            âš ï¸ Ø¦Û•Ù… Ø®ÙˆØ§Ø±Ø¯Ù†Û• Ø²Û•Ø±Û•Ø± Ø¯Û•Ú©Ø§Øª! Ù¾ÛÙˆÛŒØ³ØªÛ• Ù†Ø±Ø® Ø¨Û•Ø±Ø² Ø¨Ú©Ø±ÛØªÛ•ÙˆÛ• ÛŒØ§Ù† ØªÛÚ†ÙˆÙˆ Ú©Û•Ù… Ø¨Ú©Ø±ÛØªÛ•ÙˆÛ•
                        </div>
                    ` : ''}
                </div>
            `;
        }

        function updateProductSelectors() {
            ['ingredientProduct', 'analysisProduct', 'expenseProduct'].forEach(id => {
                const sel = document.getElementById(id);
                if (sel) {
                    const baseOptions = id === 'expenseProduct' ? '<option value="">Ù‡ÛŒÚ†Ú©Ø§Ù… - Ø®Û•Ø±Ø¬ÛŒ Ú¯Ø´ØªÛŒ</option>' : '<option value="">Ù‡Û•ÚµØ¨Ú˜ÛØ±Û•...</option>';
                    sel.innerHTML = baseOptions + data.products.map(p => `<option value="${p.id}">${p.name}</option>`).join('');
                }
            });
        }

        function init() {
            checkExistingLogin();
            showProducts(); 
            showProducts();
            showCategories();
            showAdminProducts();
            showOrders();
            showOnlineOrders();
            showExpenses();
            updateCategoriesList();
            updateStats();
            updateProductSelectors();
            updateAdminTabs();
            loadSettings();
            setupEventListeners();
            checkForOnlineMode();
            
            setInterval(checkNewOrders, 3000);
        }

        function setupEventListeners() {
            document.getElementById('customerBtn').onclick = () => switchMode('customer');
            document.getElementById('adminBtn').onclick = () => switchMode('admin');
            
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.onclick = () => switchAdminTab(tab.dataset.tab);
            });

            document.querySelectorAll('input[name="delivery"]').forEach(radio => {
                radio.onchange = () => {
                    const isDelivery = document.getElementById('delivery').checked;
                    document.getElementById('addressField').style.display = isDelivery ? 'block' : 'none';
                    document.getElementById('pickupPhoneField').style.display = isDelivery ? 'none' : 'block';
                    updateCart();
                };
            });

            document.getElementById('addProductBtn').onclick = addProduct;
            document.getElementById('updateProductBtn').onclick = updateProduct;
            document.getElementById('addCategoryBtn').onclick = addCategory;
            document.getElementById('addExpenseBtn').onclick = addExpense;
            document.getElementById('saveSettingsBtn').onclick = saveSettings;
            document.getElementById('resetBtn').onclick = resetData;
            document.getElementById('checkoutBtn').onclick = checkout;
            document.getElementById('printReceiptBtn').onclick = () => window.print();
            document.getElementById('clearBtn').onclick = clearCart;

            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.onclick = () => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    data.currentFilter = btn.dataset.filter;
                    showOrders();
                };
            });
        }

        function switchMode(mode) {
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            if (mode === 'customer') {
                document.getElementById('customerBtn').classList.add('active');
                document.getElementById('customerView').classList.add('active');
                document.getElementById('adminView').classList.remove('active');
            } else {
                document.getElementById('adminBtn').classList.add('active');
                document.getElementById('customerView').classList.remove('active');
                document.getElementById('adminView').classList.add('active');
            }
        }

        function switchAdminTab(tab) {
            document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`[data-tab="${tab}"]`).classList.add('active');
            document.querySelectorAll('.admin-content').forEach(c => c.classList.remove('active'));
            document.getElementById(tab + 'Content').classList.add('active');
        }

        function showCategories() {
            document.getElementById('categoryFilter').innerHTML = data.categories.map(c => 
                `<button class="category-btn ${c === data.currentCategory ? 'active' : ''}" onclick="filterCategory('${c}')">${c}</button>`
            ).join('');
        }

        function filterCategory(cat) {
            data.currentCategory = cat;
            showCategories();
            showProducts();
        }

        function showProducts() {
            const filtered = data.currentCategory === 'Ù‡Û•Ù…ÙˆÙˆ' ? data.products : data.products.filter(p => p.category === data.currentCategory);
            document.getElementById('products').innerHTML = filtered.map(p => {
                const outOfStock = p.stock === 0;
                const lowStock = p.stock > 0 && p.stock <= data.settings.stockAlert;
                return `<div class="product-card ${outOfStock ? 'out-of-stock' : ''}" onclick="${outOfStock ? '' : `addToCart(${p.id})`}">
                    ${outOfStock ? '<div class="stock-badge">ØªÛ•ÙˆØ§Ùˆ Ø¨ÙˆÙˆ</div>' : ''}
                    ${lowStock ? '<div class="stock-badge stock-low">Ú©Û•Ù…Û•</div>' : ''}
                    <img src="${p.image}" class="product-image" onerror="this.src='https://via.placeholder.com/200'">
                    <div class="product-name">${p.name}</div>
                    <div class="product-price">${p.price.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</div>
                    <div class="product-stock">Ø¨Û•Ø±Ø¯Û•Ø³Øª: ${p.stock}</div>
                </div>`;
            }).join('');
        }

        function addToCart(id) {
            const product = data.products.find(p => p.id === id);
            if (product.stock === 0) {
                alert('âŒ Ø¨Ø¨ÙˆØ±Û•ØŒ Ø¦Û•Ù… Ø®ÙˆØ§Ø±Ø¯Ù†Û• ØªÛ•ÙˆØ§Ùˆ Ø¨ÙˆÙˆÛ•!');
                return;
            }
            
            if (data.cart[id]) {
                if (data.cart[id].quantity >= product.stock) {
                    alert('âŒ Ø¨Ø¨ÙˆØ±Û•ØŒ Ø¨Ú•ÛŒ Ø²ÛŒØ§ØªØ± Ø¨Û•Ø±Ø¯Û•Ø³Øª Ù†ÛŒÛŒÛ•!');
                    return;
                }
                data.cart[id].quantity++;
            } else {
                data.cart[id] = { ...product, quantity: 1 };
            }
            updateCart();
        }

        function updateCart() {
            const items = Object.values(data.cart);
            const div = document.getElementById('cartItems');
            
            if (items.length === 0) {
                div.innerHTML = '<div style="text-align: center; padding: 40px; color: #999;">Ù‡ÛŒÚ† Ø¨Û•Ø±Ù‡Û•Ù…ÛÚ© Ø²ÛŒØ§Ø¯ Ù†Û•Ú©Ø±Ø§ÙˆÛ•</div>';
                document.getElementById('cartSummary').style.display = 'none';
                document.getElementById('checkoutBtn').style.display = 'none';
                document.getElementById('printReceiptBtn').style.display = 'none';
                document.getElementById('clearBtn').style.display = 'none';
                return;
            }

            div.innerHTML = items.map(i => 
                `<div class="cart-item">
                    <div style="flex: 1;">
                        <div style="font-weight: bold; margin-bottom: 5px;">${i.name}</div>
                        <div style="color: var(--primary); font-size: 1.1em;">${i.price.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</div>
                    </div>
                    <div class="cart-item-controls">
                        <button class="qty-btn" onclick="changeQty(${i.id}, -1)">-</button>
                        <span style="font-weight: bold; font-size: 1.2em; min-width: 30px; text-align: center;">${i.quantity}</span>
                        <button class="qty-btn" onclick="changeQty(${i.id}, 1)">+</button>
                        <button class="btn-small btn-delete" onclick="removeItem(${i.id})">Ã—</button>
                    </div>
                </div>`
            ).join('');

            const subtotal = items.reduce((s, i) => s + (i.price * i.quantity), 0);
            const deliveryFee = document.getElementById('delivery').checked ? data.settings.deliveryFee : 0;
            const total = subtotal + deliveryFee;

            document.getElementById('cartSummary').innerHTML = `
                <div style="background: white; padding: 20px; border-radius: 10px; margin-top: 20px;">
                    <div style="display: flex; justify-content: space-between; padding: 10px 0;">
                        <span>Ú©Û†ÛŒ Ø®ÙˆØ§Ø±Ø¯Ù†:</span>
                        <span>${subtotal.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</span>
                    </div>
                    ${deliveryFee > 0 ? `
                    <div style="display: flex; justify-content: space-between; padding: 10px 0;">
                        <span>ØªÛÚ†ÙˆÙˆÙ†ÛŒ Ú¯Û•ÛŒØ§Ù†Ø¯Ù†:</span>
                        <span>${deliveryFee.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</span>
                    </div>` : ''}
                    <div style="display: flex; justify-content: space-between; padding: 10px 0; font-size: 1.5em; font-weight: bold; color: var(--primary); border-top: 3px solid var(--primary); margin-top: 10px; padding-top: 15px;">
                        <span>Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ:</span>
                        <span>${total.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</span>
                    </div>
                </div>`;

            document.getElementById('cartSummary').style.display = 'block';
            document.getElementById('checkoutBtn').style.display = 'block';
            document.getElementById('printReceiptBtn').style.display = 'block';
            document.getElementById('clearBtn').style.display = 'block';
        }

        function changeQty(id, change) {
            const product = data.products.find(p => p.id === id);
            const newQty = data.cart[id].quantity + change;
            
            if (newQty > product.stock) {
                alert('âŒ Ø¨Ø¨ÙˆØ±Û•ØŒ Ø¨Ú•ÛŒ Ø²ÛŒØ§ØªØ± Ø¨Û•Ø±Ø¯Û•Ø³Øª Ù†ÛŒÛŒÛ•!');
                return;
            }
            
            if (newQty <= 0) {
                delete data.cart[id];
            } else {
                data.cart[id].quantity = newQty;
            }
            updateCart();
        }

        function removeItem(id) {
            delete data.cart[id];
            updateCart();
        }

        function clearCart() {
            if (confirm('Ø¯ÚµÙ†ÛŒØ§ÛŒØª Ù„Û• Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ù‡Û•Ù…ÙˆÙˆ Ø¨Û•Ø±Ù‡Û•Ù…Û•Ú©Ø§Ù†ØŸ')) {
                data.cart = {};
                updateCart();
            }
        }

        function checkout() {
            const items = Object.values(data.cart);
            if (items.length === 0) return;

            const isDelivery = document.getElementById('delivery').checked;
            const subtotal = items.reduce((s, i) => s + (i.price * i.quantity), 0);
            const deliveryFee = isDelivery ? data.settings.deliveryFee : 0;
            const total = subtotal + deliveryFee;

            let phone, address, location;

            if (isDelivery) {
                address = document.getElementById('deliveryAddress').value.trim();
                location = document.getElementById('deliveryLocation').value.trim();
                phone = document.getElementById('deliveryPhone').value.trim();

                if (!address || !phone) {
                    alert('âŒ ØªÚ©Ø§ÛŒÛ• Ù†Ø§ÙˆÙ†ÛŒØ´Ø§Ù† Ùˆ Ú˜Ù…Ø§Ø±Û•ÛŒ Ù…Û†Ø¨Ø§ÛŒÙ„ Ø¨Ù†ÙˆÙˆØ³Û•!');
                    return;
                }
            } else {
                phone = document.getElementById('pickupPhone').value.trim();
                address = 'Ù„Û• Ø´ÙˆÛÙ†';

                if (!phone) {
                    alert('âŒ ØªÚ©Ø§ÛŒÛ• Ú˜Ù…Ø§Ø±Û•ÛŒ Ù…Û†Ø¨Ø§ÛŒÙ„ Ø¨Ù†ÙˆÙˆØ³Û•!');
                    return;
                }
            }

            const urlParams = new URLSearchParams(window.location.search);
            const isOnlineOrder = urlParams.get('mode') === 'order';

            items.forEach(item => {
                const product = data.products.find(p => p.id === item.id);
                product.stock -= item.quantity;
            });

            const order = {
                id: Date.now(),
                number: isOnlineOrder ? data.onlineOrders.length + 1 : data.orders.length + 1,
                date: new Date().toISOString(),
                items: items,
                subtotal: subtotal,
                deliveryFee: deliveryFee,
                total: total,
                deliveryType: isDelivery ? 'Ú¯Û•ÛŒØ§Ù†Ø¯Ù†' : 'Ù„Û• Ø´ÙˆÛÙ†',
                address: address,
                location: location || null,
                phone: phone
            };

            if (isOnlineOrder) {
                data.onlineOrders.push(order);
            } else {
                data.orders.push(order);
            }

            currentOrder = order;
            save();
            
            showReceipt(order);
            data.cart = {};
            updateCart();
            showProducts();
            showAdminProducts();
            showOrders();
            showOnlineOrders();
            updateStats();
        }

        function showReceipt(order) {
            const receipt = `
                <div class="receipt-header">
                    <div class="receipt-title">ğŸ” ${data.settings.name} ğŸ•</div>
                    <div style="color: #666; font-size: 0.9em; line-height: 1.6;">
                        <div>Ú˜Ù…Ø§Ø±Û•ÛŒ Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ: #${order.number.toString().padStart(4, '0')}</div>
                        <div>Ø¨Û•Ø±ÙˆØ§Ø±: ${new Date(order.date).toLocaleDateString('ar-IQ')}</div>
                        <div>Ú©Ø§Øª: ${new Date(order.date).toLocaleTimeString('ar-IQ')}</div>
                        <div>Ø¬Û†Ø±: ${order.deliveryType}</div>
                        ${order.phone ? `<div>ğŸ“± ${order.phone}</div>` : ''}
                        ${order.deliveryType === 'Ú¯Û•ÛŒØ§Ù†Ø¯Ù†' ? `
                            <div>ğŸ“ ${order.address}</div>
                            ${order.location ? `<div>ğŸ—ºï¸ <a href="${order.location}" target="_blank">Ù„Û†Ú©Û•ÛŒØ´Ù†</a></div>` : ''}
                        ` : ''}
                    </div>
                </div>
                <div style="margin: 20px 0;">
                    ${order.items.map(item => `
                        <div style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #eee;">
                            <div>
                                <div style="font-weight: bold;">${item.name}</div>
                                <div style="color: #666; font-size: 0.9em;">${item.quantity} Ã— ${item.price.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</div>
                            </div>
                            <div style="font-weight: bold;">${(item.quantity * item.price).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</div>
                        </div>
                    `).join('')}
                </div>
                <div style="border-top: 2px dashed #333; padding-top: 20px;">
                    <div style="display: flex; justify-content: space-between; padding: 5px 0;">
                        <span>Ú©Û†ÛŒ Ø®ÙˆØ§Ø±Ø¯Ù†:</span>
                        <span>${order.subtotal.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</span>
                    </div>
                    ${order.deliveryFee > 0 ? `
                    <div style="display: flex; justify-content: space-between; padding: 5px 0;">
                        <span>ØªÛÚ†ÙˆÙˆÙ†ÛŒ Ú¯Û•ÛŒØ§Ù†Ø¯Ù†:</span>
                        <span>${order.deliveryFee.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</span>
                    </div>` : ''}
                    <div style="display: flex; justify-content: space-between; font-size: 1.5em; font-weight: bold; color: var(--primary); margin-top: 15px; padding-top: 15px; border-top: 2px solid var(--primary);">
                        <span>Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ:</span>
                        <span>${order.total.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</span>
                    </div>
                </div>
                <div style="text-align: center; color: #666; margin-top: 30px; font-style: italic;">
                    Ø³ÙˆÙ¾Ø§Ø³ Ø¨Û† Ú©Ú•ÛŒÙ†Û•Ú©Û•Øª! ğŸ™<br>
                    Ú†Ø§ÙˆÛ•Ú•ÙˆØ§Ù†ÛŒ Ø¯ÙˆÙˆØ¨Ø§Ø±Û• Ù‡Ø§ØªÙ†Û•ÙˆÛ•ØªØ§Ù† Ø¯Û•Ú©Û•ÛŒÙ†
                </div>`;

            document.getElementById('receiptContent').innerHTML = receipt;
            document.getElementById('receiptModal').classList.add('active');
        }

        function closeReceipt() {
            document.getElementById('receiptModal').classList.remove('active');
        }

        function showOrders() {
            let filtered = data.orders;
            const now = new Date();
            
            if (data.currentFilter === 'today') {
                filtered = data.orders.filter(o => {
                    const orderDate = new Date(o.date);
                    return orderDate.toDateString() === now.toDateString();
                });
            } else if (data.currentFilter === 'week') {
                const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                filtered = data.orders.filter(o => new Date(o.date) >= weekAgo);
            } else if (data.currentFilter === 'month') {
                const monthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
                filtered = data.orders.filter(o => new Date(o.date) >= monthAgo);
            }

            const totalValue = filtered.reduce((s, o) => s + o.total, 0);

            document.getElementById('totalOrdersCount').textContent = filtered.length;
            document.getElementById('totalOrdersValue').textContent = totalValue.toLocaleString() + ' Ø¯ÛŒÙ†Ø§Ø±';

            document.getElementById('ordersList').innerHTML = filtered.reverse().map(order => `
                <div class="order-item">
                    <div class="order-header">
                        <div>
                            <div class="order-number">#${order.number.toString().padStart(4, '0')}</div>
                            <div class="order-date">
                                ${new Date(order.date).toLocaleDateString('ar-IQ')} - 
                                ${new Date(order.date).toLocaleTimeString('ar-IQ')}
                            </div>
                        </div>
                        <div style="text-align: left;">
                            <div style="font-weight: bold;">${order.deliveryType}</div>
                            ${order.phone ? `<div style="font-size: 0.9em; color: #666;">ğŸ“± ${order.phone}</div>` : ''}
                            ${order.deliveryType === 'Ú¯Û•ÛŒØ§Ù†Ø¯Ù†' ? `
                                <div style="font-size: 0.9em; color: #666;">ğŸ“ ${order.address}</div>
                                ${order.location ? `<a href="${order.location}" target="_blank" style="font-size: 0.9em; color: var(--primary);">ğŸ—ºï¸ Ù„Û†Ú©Û•ÛŒØ´Ù†</a>` : ''}
                            ` : ''}
                        </div>
                    </div>
                    <div class="order-items">
                        ${order.items.map(item => `
                            <div class="order-item-row">
                                <span>${item.name} Ã— ${item.quantity}</span>
                                <span>${(item.price * item.quantity).toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</span>
                            </div>
                        `).join('')}
                    </div>
                    <div class="order-total">
                        <span>Ú©Û†ÛŒ Ú¯Ø´ØªÛŒ:</span>
                        <span>${order.total.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</span>
                    </div>
                    <div class="order-actions">
                        <button class="btn-small btn-edit" onclick="editOrder(${order.id})">âœï¸ Ø¯Û•Ø³ØªÚ©Ø§Ø±ÛŒ</button>
                        <button class="btn-small btn-edit" onclick="viewOrder(${order.id})">ğŸ‘ï¸ Ø¨ÛŒÙ†ÛŒÙ†</button>
                        <button class="btn-small btn-delete" onclick="deleteOrder(${order.id})">ğŸ—‘ï¸ Ø³Ú•ÛŒÙ†Û•ÙˆÛ•</button>
                    </div>
                </div>
            `).join('');
        }

        function viewOrder(id) {
            const order = data.orders.find(o => o.id === id);
            showReceipt(order);
        }

        function editOrder(id) {
            const order = data.orders.find(o => o.id === id);
            document.getElementById('editOrderId').value = order.id;
            
            if (order.deliveryType === 'Ú¯Û•ÛŒØ§Ù†Ø¯Ù†') {
                document.getElementById('editDelivery').checked = true;
                document.getElementById('editAddressField').style.display = 'block';
                document.getElementById('editOrderAddress').value = order.address;
            } else {
                document.getElementById('editPickup').checked = true;
                document.getElementById('editAddressField').style.display = 'none';
            }
            
            showEditOrderItems(order);
            
            document.querySelectorAll('input[name="editDelivery"]').forEach(radio => {
                radio.onchange = () => {
                    document.getElementById('editAddressField').style.display = 
                        document.getElementById('editDelivery').checked ? 'block' : 'none';
                    updateEditOrderTotal();
                };
            });
            
            document.getElementById('editOrderModal').classList.add('active');
        }

        function showEditOrderItems(order) {
            const div = document.getElementById('editOrderItems');
            div.innerHTML = order.items.map((item, index) => `
                <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 10px;">
<div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="flex: 1;">
                            <div style="font-weight: bold; margin-bottom: 5px;">${item.name}</div>
                            <div style="color: #666;">${item.price.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</div>
                        </div>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <button class="qty-btn" onclick="changeEditOrderQty(${index}, -1)">-</button>
                            <span style="font-weight: bold; font-size: 1.2em; min-width: 30px; text-align: center;" id="editQty${index}">${item.quantity}</span>
                            <button class="qty-btn" onclick="changeEditOrderQty(${index}, 1)">+</button>
                            <button class="btn-small btn-delete" onclick="removeEditOrderItem(${index})">Ã—</button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            updateEditOrderTotal();
        }

        function changeEditOrderQty(index, change) {
            const orderId = parseInt(document.getElementById('editOrderId').value);
            const order = data.orders.find(o => o.id === orderId);
            
            order.items[index].quantity += change;
            
            if (order.items[index].quantity <= 0) {
                order.items.splice(index, 1);
            }
            
            if (order.items.length === 0) {
                alert('âŒ Ù†Ø§Ø¨ÛØª Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ Ø¨Û•ØªØ§Úµ Ø¨ÛØª!');
                closeEditOrderModal();
                return;
            }
            
            showEditOrderItems(order);
        }

        function removeEditOrderItem(index) {
            if (!confirm('Ø¯ÚµÙ†ÛŒØ§ÛŒØª Ù„Û• Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ø¦Û•Ù… Ø®ÙˆØ§Ø±Ø¯Ù†Û•ØŸ')) return;
            
            const orderId = parseInt(document.getElementById('editOrderId').value);
            const order = data.orders.find(o => o.id === orderId);
            
            order.items.splice(index, 1);
            
            if (order.items.length === 0) {
                alert('âŒ Ù†Ø§Ø¨ÛØª Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ Ø¨Û•ØªØ§Úµ Ø¨ÛØª!');
                closeEditOrderModal();
                return;
            }
            
            showEditOrderItems(order);
        }

        function updateEditOrderTotal() {
            const orderId = parseInt(document.getElementById('editOrderId').value);
            const order = data.orders.find(o => o.id === orderId);
            
            const subtotal = order.items.reduce((s, i) => s + (i.price * i.quantity), 0);
            const deliveryFee = document.getElementById('editDelivery').checked ? data.settings.deliveryFee : 0;
            const total = subtotal + deliveryFee;
            
            document.getElementById('editSubtotal').textContent = subtotal.toLocaleString() + ' Ø¯ÛŒÙ†Ø§Ø±';
            document.getElementById('editDeliveryFeeAmount').textContent = deliveryFee.toLocaleString() + ' Ø¯ÛŒÙ†Ø§Ø±';
            document.getElementById('editTotal').textContent = total.toLocaleString() + ' Ø¯ÛŒÙ†Ø§Ø±';
            document.getElementById('editDeliveryFeeRow').style.display = deliveryFee > 0 ? 'flex' : 'none';
        }

        function saveOrderEdit() {
            const orderId = parseInt(document.getElementById('editOrderId').value);
            const order = data.orders.find(o => o.id === orderId);
            
            if (order.items.length === 0) {
                alert('âŒ Ù†Ø§Ø¨ÛØª Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ Ø¨Û•ØªØ§Úµ Ø¨ÛØª!');
                return;
            }
            
            const deliveryType = document.getElementById('editDelivery').checked ? 'Ú¯Û•ÛŒØ§Ù†Ø¯Ù†' : 'Ù„Û• Ø´ÙˆÛÙ†';
            const address = deliveryType === 'Ú¯Û•ÛŒØ§Ù†Ø¯Ù†' ? document.getElementById('editOrderAddress').value : 'Ù„Û• Ø´ÙˆÛÙ†';
            
            if (deliveryType === 'Ú¯Û•ÛŒØ§Ù†Ø¯Ù†' && !address.trim()) {
                alert('âŒ ØªÚ©Ø§ÛŒÛ• Ù†Ø§ÙˆÙ†ÛŒØ´Ø§Ù† Ø¨Ù†ÙˆÙˆØ³Û•!');
                return;
            }
            
            const subtotal = order.items.reduce((s, i) => s + (i.price * i.quantity), 0);
            const deliveryFee = deliveryType === 'Ú¯Û•ÛŒØ§Ù†Ø¯Ù†' ? data.settings.deliveryFee : 0;
            
            order.deliveryType = deliveryType;
            order.address = address;
            order.subtotal = subtotal;
            order.deliveryFee = deliveryFee;
            order.total = subtotal + deliveryFee;
            
            save();
            closeEditOrderModal();
            showOrders();
            showExpenses();
            alert('âœ… Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒ Ø¯Û•Ø³ØªÚ©Ø§Ø±ÛŒ Ú©Ø±Ø§!');
        }

        function closeEditOrderModal() {
            document.getElementById('editOrderModal').classList.remove('active');
        }

        function deleteOrder(id) {
            if (confirm('Ø¯ÚµÙ†ÛŒØ§ÛŒØª Ù„Û• Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ø¦Û•Ù… Ø¯Ø§ÙˆØ§Ú©Ø§Ø±ÛŒÛ•ØŸ')) {
                data.orders = data.orders.filter(o => o.id !== id);
                save();
                showOrders();
                updateStats();
            }
        }

        function showExpenses() {
            const totalRevenue = data.orders.reduce((s, o) => s + o.total, 0);
            const totalExpenses = data.expenses.reduce((s, e) => s + e.amount, 0);
            const profit = totalRevenue - totalExpenses;

            document.getElementById('totalRevenue').textContent = totalRevenue.toLocaleString() + ' Ø¯ÛŒÙ†Ø§Ø±';
            document.getElementById('totalExpenses').textContent = totalExpenses.toLocaleString() + ' Ø¯ÛŒÙ†Ø§Ø±';
            document.getElementById('totalProfit').textContent = profit.toLocaleString() + ' Ø¯ÛŒÙ†Ø§Ø±';
            document.getElementById('totalProfit').style.color = profit >= 0 ? '#2ecc71' : '#e74c3c';

            document.getElementById('expensesList').innerHTML = data.expenses.map(exp => {
                const product = exp.productId ? data.products.find(p => p.id === exp.productId) : null;
                return `<div class="expense-item">
                    <div>
                        <div style="font-weight: bold; font-size: 1.1em;">${exp.type}</div>
                        ${product ? `<div style="color: var(--primary); font-size: 0.9em;">ğŸ“¦ ${product.name}</div>` : ''}
                        <div style="color: #666; font-size: 0.9em;">${new Date(exp.date).toLocaleDateString('ar-IQ')}</div>
                    </div>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <div style="font-size: 1.2em; font-weight: bold; color: #e74c3c;">${exp.amount.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</div>
                        <button class="btn-small btn-delete" onclick="deleteExpense(${exp.id})">Ã—</button>
                    </div>
                </div>`;
            }).join('');
        }

        function addExpense() {
            const type = document.getElementById('expenseType').value.trim();
            const amount = parseInt(document.getElementById('expenseAmount').value);
            const productId = document.getElementById('expenseProduct').value;

            if (!type || !amount || amount <= 0) {
                alert('âŒ ØªÚ©Ø§ÛŒÛ• Ù‡Û•Ù…ÙˆÙˆ Ø®Ø§Ù†Û•Ú©Ø§Ù† Ù¾Ú•Ø¨Ú©Û•Ø±Û•ÙˆÛ•!');
                return;
            }

            data.expenses.push({
                id: Date.now(),
                type: type,
                amount: amount,
                productId: productId ? parseInt(productId) : null,
                date: new Date().toISOString()
            });

            save();
            showExpenses();
            
            document.getElementById('expenseType').value = '';
            document.getElementById('expenseAmount').value = '';
            document.getElementById('expenseProduct').value = '';
            
            alert('âœ… Ø®Û•Ø±Ø¬ÛŒ Ø²ÛŒØ§Ø¯Ú©Ø±Ø§!');
        }

        function deleteExpense(id) {
            if (confirm('Ø¯ÚµÙ†ÛŒØ§ÛŒØª Ù„Û• Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ø¦Û•Ù… Ø®Û•Ø±Ø¬ÛŒÛŒÛ•ØŸ')) {
                data.expenses = data.expenses.filter(e => e.id !== id);
                save();
                showExpenses();
            }
        }

        function showAdminProducts() {
            document.getElementById('adminProductsList').innerHTML = data.products.map(p => {
                const lowStock = p.stock <= data.settings.stockAlert;
                return `<div class="product-item">
                    <img src="${p.image}" onerror="this.src='https://via.placeholder.com/100'">
                    <div class="product-item-info">
                        <div style="font-size: 1.3em; font-weight: bold;">${p.name}</div>
                        <div style="color: var(--primary); font-size: 1.2em; font-weight: bold;">${p.price.toLocaleString()} Ø¯ÛŒÙ†Ø§Ø±</div>
                        <div style="color: #666; margin-top: 5px;">Ø¨Û•Ø´: ${p.category}</div>
                        <div style="color: ${lowStock ? '#e74c3c' : '#2ecc71'}; font-weight: bold; margin-top: 5px;">
                            Ø¨Û•Ø±Ø¯Û•Ø³Øª: ${p.stock} ${lowStock ? 'âš ï¸' : ''}
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn-small btn-edit" onclick="editProduct(${p.id})">âœï¸</button>
                        <button class="btn-small btn-delete" onclick="deleteProduct(${p.id})">ğŸ—‘ï¸</button>
                    </div>
                </div>`;
            }).join('');
            
            updateSelects();
        }

        function addProduct() {
            const name = document.getElementById('productName').value.trim();
            const price = parseInt(document.getElementById('productPrice').value);
            const category = document.getElementById('productCategory').value;
            const stock = parseInt(document.getElementById('productStock').value);
            const image = document.getElementById('productImage').value.trim() || 'https://via.placeholder.com/200';

            if (!name || !price || !category || stock < 0 || price <= 0) {
                alert('âŒ ØªÚ©Ø§ÛŒÛ• Ù‡Û•Ù…ÙˆÙˆ Ø®Ø§Ù†Û•Ú©Ø§Ù† Ù¾Ú•Ø¨Ú©Û•Ø±Û•ÙˆÛ•!');
                return;
            }

            data.products.push({
                id: Date.now(),
                name, price, category, stock, 
                ingredients: [],
                image
            });

            save();
            showProducts();
            showAdminProducts();
            updateProductSelectors();
            
            document.getElementById('productName').value = '';
            document.getElementById('productPrice').value = '';
            document.getElementById('productStock').value = '100';
            document.getElementById('productImage').value = '';
            
            alert('âœ… Ø®ÙˆØ§Ø±Ø¯Ù† Ø²ÛŒØ§Ø¯Ú©Ø±Ø§!');
        }

        function editProduct(id) {
            const p = data.products.find(x => x.id === id);
            document.getElementById('editProductId').value = p.id;
            document.getElementById('editProductName').value = p.name;
            document.getElementById('editProductPrice').value = p.price;
            document.getElementById('editProductStock').value = p.stock;
            document.getElementById('editProductCategory').value = p.category;
            document.getElementById('editProductImage').value = p.image;
            document.getElementById('editModal').classList.add('active');
        }

        function updateProduct() {
            const id = parseInt(document.getElementById('editProductId').value);
            const index = data.products.findIndex(p => p.id === id);
            
            const name = document.getElementById('editProductName').value.trim();
            const price = parseInt(document.getElementById('editProductPrice').value);
            const stock = parseInt(document.getElementById('editProductStock').value);
            const category = document.getElementById('editProductCategory').value;
            const image = document.getElementById('editProductImage').value.trim();

            if (!name || !price || stock < 0 || price <= 0) {
                alert('âŒ ØªÚ©Ø§ÛŒÛ• Ù‡Û•Ù…ÙˆÙˆ Ø®Ø§Ù†Û•Ú©Ø§Ù† Ù¾Ú•Ø¨Ú©Û•Ø±Û•ÙˆÛ•!');
                return;
            }

            data.products[index] = {
                ...data.products[index],
                name, price, stock, category,
                image: image || data.products[index].image
            };

            save();
            showProducts();
            showAdminProducts();
            closeEditModal();
            alert('âœ… Ú¯Û†Ú•Ø§Ù†Ú©Ø§Ø±ÛŒ Ù¾Ø§Ø´Û•Ú©Û•ÙˆØª Ú©Ø±Ø§!');
        }

        function closeEditModal() {
            document.getElementById('editModal').classList.remove('active');
        }

        function deleteProduct(id) {
            if (confirm('Ø¯ÚµÙ†ÛŒØ§ÛŒØª Ù„Û• Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ø¦Û•Ù… Ø®ÙˆØ§Ø±Ø¯Ù†Û•ØŸ')) {
                data.products = data.products.filter(p => p.id !== id);
                save();
                showProducts();
                showAdminProducts();
                updateProductSelectors();
                alert('âœ… Ø®ÙˆØ§Ø±Ø¯Ù† Ø³Ú•Ø§ÛŒÛ•ÙˆÛ•!');
            }
        }

        function updateSelects() {
            const cats = data.categories.filter(c => c !== 'Ù‡Û•Ù…ÙˆÙˆ');
            ['productCategory', 'editProductCategory'].forEach(id => {
                const sel = document.getElementById(id);
                if (sel) sel.innerHTML = cats.map(c => `<option value="${c}">${c}</option>`).join('');
            });
        }

        function addCategory() {
            const newCat = document.getElementById('newCategory').value.trim();
            if (!newCat) {
                alert('âŒ Ù†Ø§ÙˆÛŒ Ø¨Û•Ø´ Ø¨Ù†ÙˆÙˆØ³Û•!');
                return;
            }
            
            if (data.categories.includes(newCat)) {
                alert('âŒ Ø¦Û•Ù… Ø¨Û•Ø´Û• Ù‡Û•ÛŒÛ•!');
                return;
            }
            
            data.categories.push(newCat);
            save();
            showCategories();
            updateCategoriesList();
            updateSelects();
            document.getElementById('newCategory').value = '';
            alert('âœ… Ø¨Û•Ø´ Ø²ÛŒØ§Ø¯Ú©Ø±Ø§!');
        }

        function updateCategoriesList() {
            const list = document.getElementById('categoriesList');
            list.innerHTML = '<div style="margin-top: 20px;">' + 
                data.categories.filter(c => c !== 'Ù‡Û•Ù…ÙˆÙˆ').map(c => `
                    <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
                        <span style="font-size: 1.1em; font-weight: bold;">${c}</span>
                        <button class="btn-small btn-delete" onclick="deleteCategory('${c}')">ğŸ—‘ï¸</button>
                    </div>
                `).join('') + '</div>';
        }

        function deleteCategory(cat) {
            if (confirm(`Ø¯ÚµÙ†ÛŒØ§ÛŒØª Ù„Û• Ø³Ú•ÛŒÙ†Û•ÙˆÛ•ÛŒ Ø¨Û•Ø´ÛŒ "${cat}"ØŸ`)) {
                data.categories = data.categories.filter(c => c !== cat);
                data.products.forEach(p => {
                    if (p.category === cat) p.category = 'Ø®ÙˆØ§Ø±Ø¯Ù†';
                });
                save();
                showCategories();
                updateCategoriesList();
                updateSelects();
                showProducts();
                showAdminProducts();
                alert('âœ… Ø¨Û•Ø´ Ø³Ú•Ø§ÛŒÛ•ÙˆÛ•!');
            }
        }

        function loadSettings() {
            document.getElementById('restaurantName').value = data.settings.name;
            document.getElementById('deliveryFeeInput').value = data.settings.deliveryFee;
            document.getElementById('stockAlert').value = data.settings.stockAlert;
            document.getElementById('appTitle').textContent = 'ğŸ” ' + data.settings.name + ' ğŸ•';

            Object.keys(data.features).forEach(feature => {
                const checkbox = document.getElementById('feature_' + feature);
                if (checkbox) checkbox.checked = data.features[feature];
            });
        }

        function saveSettings() {
            const name = document.getElementById('restaurantName').value.trim();
            const deliveryFee = parseInt(document.getElementById('deliveryFeeInput').value);
            const stockAlert = parseInt(document.getElementById('stockAlert').value);

            if (!name || deliveryFee < 0 || stockAlert < 0) {
                alert('âŒ ØªÚ©Ø§ÛŒÛ• Ù‡Û•Ù…ÙˆÙˆ Ø®Ø§Ù†Û•Ú©Ø§Ù† Ù¾Ú•Ø¨Ú©Û•Ø±Û•ÙˆÛ•!');
                return;
            }

            data.settings.name = name;
            data.settings.deliveryFee = deliveryFee;
            data.settings.stockAlert = stockAlert;
            
            save();
            loadSettings();
            document.getElementById('deliveryFee').textContent = deliveryFee;
            
            alert('âœ… Ú•ÛÚ©Ø®Ø³ØªÙ†Û•Ú©Ø§Ù† Ù¾Ø§Ø´Û•Ú©Û•ÙˆØª Ú©Ø±Ø§Ù†!');
        }

        function updateStats() {
            // Stats updated in respective functions
        }

        function resetData() {
            if (confirm('âš ï¸ Ø¯ÚµÙ†ÛŒØ§ÛŒØªØŸ Ù‡Û•Ù…ÙˆÙˆ Ø²Ø§Ù†ÛŒØ§Ø±ÛŒÛŒÛ•Ú©Ø§Ù† Ø¯Û•Ø³Ú•ÛÙ†Û•ÙˆÛ•!')) {
                if (confirm('âš ï¸ Ø¯ÚµÙ†ÛŒØ§ÛŒ ØªÛ•ÙˆØ§ÙˆÛŒØŸ Ø¦Û•Ù… Ú©Ø§Ø±Û• Ù†Ø§Ú¯Û•Ú•ÛØªÛ•ÙˆÛ•!')) {
                    localStorage.clear();
                    location.reload();
                }
            }
        }

        // Initialize
        loadData();
        init();
    </script>
</body>
</html>
